import mongoose from "mongoose";

const productSchema = new mongoose.Schema(
  {
    userId: {
      type: String,
      required: true,
    },
    name: { type: String, required: true }, // Ensure unique names
    type: { type: String, required: true }, // (e.g., Wine, Spirit)
    category: { type: String, required: true },
    vintage: Number, // For wines
    yearDistilled: Number, // For spirits
    price: { type: Number, required: true },
    quantity: { type: Number, required: true, default: 0 },
    barcode: { type: String, unique: true, sparse: true, index: true },
    inStock: { type: Boolean, default: true }, // Track stock availability
    imageUrl: {
      type: String,
      default:
        "data:image/jpeg;base64,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aZeMSTji2T/Fcn33LPUNwDPu8MHdl+SF24Z2yMjykrg88k85mnoa9Pr7P257d9C5UI+0VcEbC+fUMS2D6sPYSHo7etycadXQnJGSCfmW5z9xJfsrvVTRWKhoHqQfkrCFRk5PHl9eZfVXL13PCqLfrO1qa7ErssVXc4VSQCxwTxnr0lO759iVm8XCxqy+wFVxssKNv3MMckruBPsflMfbHafZ+rsquv0l7PScocY9QcMFfDDIzg/3M9dv96EuQqunuOQRk7V6/QmRaSWm76k33LR2v2WNRS9TcBhwfYjlT9iBOQ9q9ytYhIFDuPdBuB/SdE7v/iDUVWvVA1WAAEn4XxxuB/t6S5aTX0WDKWI30ImGTDGfM2x5pQ5H5xfu1rB/6W7/AIDPVPdbWnppLv8AgM/TArHuIKD3Ez8NHubeMmcM7v8AcDVO6+LWakyNxbGceoA65nV79NipgBgBCB9AOJJajXUVjL3Vr9WErHaffKiwmjTnxN3D2D4UU/EFPqxHAx0zn5HXHijDZHnyZZT3kS6nIzPs8UtkAz3PSeIREQBPjLmfYgEF2h3crsOSJD29yEMusSKLWyi//wAKszU9yEEukRQ1Mguz+7ldZyBJxVwMT7EEWIiJJAmrrdEtgwZtRBJVNT3OrbpNJ+46y8RIonUykJ3JHuZtafubWOstsRQ1Mj9J2RWgwFEyt2dWfyibcQQaX+i6/wCET1/o6v8AhE24gEPqu7tT9VEir+5dR6ACW2IoWykN3IX0M8juOvqZeYiidTKbT3IrHUCS+g7u118gSbiKItnxVxPsRJIEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREAREQBERAEREA/9k=",
    }, // Optional
    description: String,
    slug: {
      type: String,
      required: true,
      unique: true,
    },
  },
  { timestamps: true }
);

productSchema.pre("save", async function (next) {
  this.inStock = this.quantity > 0;
  next();
});

const Product = mongoose.model("Product", productSchema);

export default Product;
